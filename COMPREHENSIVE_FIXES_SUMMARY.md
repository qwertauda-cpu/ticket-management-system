# ๐ง ููุฎุต ุดุงูู ูุฌููุน ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

## โ ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง:

### 1. **ูุดููุฉ SuperAdminModule - JwtService Dependency** โ
**ุงููุดููุฉ:** Backend ูุงู ูุนูุฏ ุงูุชุดุบูู ุจุงุณุชูุฑุงุฑ ุจุณุจุจ ุฎุทุฃ ูู SuperAdminGuard ูุน JwtService.

**ุงูุญู:**
- ุชู ุฅุฒุงูุฉ JwtModule.register ุงูููุฑุฑ ูู SuperAdminModule
- ุงูุงุนุชูุงุฏ ููุท ุนูู JwtModule ูู AuthModule (ุงูุฐู ูุชู ุชุตุฏูุฑู)

**ุงููููุงุช ุงููุนุฏูุฉ:**
- `backend/src/super-admin/super-admin.module.ts`

### 2. **ูุดููุฉ PM2 Environment Variables** โ
**ุงููุดููุฉ:** PM2 ูุง ููุฑุฃ ููู .env ุจุดูู ุตุญูุญุ ููุง ูุณุจุจ ุฎุทุฃ "Missing required environment variable: JWT_SECRET".

**ุงูุญู:**
- ุชู ุชุญุฏูุซ `ecosystem.config.js` ููุฑุงุกุฉ ููู .env ูุจุงุดุฑุฉ
- ุชู ุฅุถุงูุฉ ูุฑุงุกุฉ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ูู .env file ูู ecosystem.config.js

**ุงููููุงุช ุงููุนุฏูุฉ:**
- `backend/ecosystem.config.js`

### 3. **ูุดููุฉ Super Admin Login - Email Validation** โ
**ุงููุดููุฉ:** ูุงู ุงูุชุญูู ูุชุทูุจ ุชูุณูู ุจุฑูุฏ ุฅููุชุฑููู ุตุญูุญ.

**ุงูุญู:**
- ุชู ุชุบููุฑ `@IsEmail()` ุฅูู `@IsString()` ูู SuperAdminLoginDto
- ุชู ุชุญุฏูุซ ุญุณุงุจ Super Admin ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ูุนูููุงุช ุชุณุฌูู ุงูุฏุฎูู:**
- Username: `admin`
- Password: `admin123`

**ุงููููุงุช ุงููุนุฏูุฉ:**
- `backend/src/super-admin/dto/super-admin-login.dto.ts`

### 4. **ุฅูุดุงุก ููู PM2 Configuration** โ
**ุงููุดููุฉ:** ูู ููู ููุงู ููู ecosystem.config.js.

**ุงูุญู:**
- ุชู ุฅูุดุงุก `backend/ecosystem.config.js` ูุน ุงูุฅุนุฏุงุฏุงุช ุงูุตุญูุญุฉ

**ุงููููุงุช ุงูุฌุฏูุฏุฉ:**
- `backend/ecosystem.config.js`

### 5. **ุญุฐู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ** โ
**ุงููุดููุฉ:** ูุงูุช ููุงู ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

**ุงูุญู:**
- ุชู ุฅูุดุงุก ุณูุฑูุจุช `backend/scripts/clean-demo-data.ts`
- ุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
- ุชู ุงูุงุญุชูุงุธ ููุท ุจุญุณุงุจ Super Admin

**ุงููููุงุช ุงูุฌุฏูุฏุฉ:**
- `backend/scripts/clean-demo-data.ts`

### 6. **ุฅุถุงูุฉ ุญููู maxUsers ู pricePerUser** โ
**ุงููุดููุฉ:** ุงูุญููู ููุฌูุฏุฉ ูู ุงูููุฏ ููููุง ูุง ุชุธูุฑ ูู ุงููุงุฌูุฉ.

**ุงูุญู:**
- ุชู ุฅุถุงูุฉ cache control headers ูู index.html
- ุชู ุฅุนุงุฏุฉ ุจูุงุก Admin Dashboard
- ุงูุญููู ููุฌูุฏุฉ ูู ุงูููุฏ ูุงููููุงุช ุงููุฑููุนุฉ

**ุงููููุงุช ุงููุนุฏูุฉ:**
- `admin-dashboard/index.html`
- `admin-dashboard/src/pages/CompaniesPage.tsx`

## ๐ ุญุงูุฉ ุงููุดุฑูุน ุงูุญุงููุฉ:

### โ Backend:
- โ ุงูููุฏ ูุญุฏุซ ููุตุญุญ
- โ SuperAdminModule ูุนูู ุจุดูู ุตุญูุญ
- โ PM2 ููุฑุฃ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุจุดูู ุตุญูุญ
- โ ุชุณุฌูู ุงูุฏุฎูู ูุนูู ูุน `admin` / `admin123`
- โ๏ธ ูุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุจูุงุก ุนูู ุงูุณูุฑูุฑ

### โ Frontend (Admin Dashboard):
- โ ุงูููุฏ ูุญุฏุซ
- โ ุงูุญููู ุงูุฌุฏูุฏุฉ ููุฌูุฏุฉ (maxUsers, pricePerUser)
- โ ุงููููุงุช ุงููุจููุฉ ูุญุฏุซุฉ ุนูู ุงูุณูุฑูุฑ
- โ๏ธ ูุฏ ูุญุชุงุฌ ุฅูู ุชุญุฏูุซ cache ุงููุชุตูุญ

### โ ูุงุนุฏุฉ ุงูุจูุงูุงุช:
- โ ูุธููุฉ ูู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
- โ Super Admin ููุฌูุฏ: `admin` / `admin123`
- โ ุฌููุน ุงูู migrations ูุทุจูุฉ

## ๐ ุฎุทูุงุช ุงูุชุทุจูู ุนูู ุงูุณูุฑูุฑ:

```bash
# 1. ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ
ssh qwertauda@136.111.97.150

# 2. ุณุญุจ ุขุฎุฑ ุงูุชุญุฏูุซุงุช
cd ~/ticket-management-system
git pull origin main

# 3. ุฅุนุงุฏุฉ ุจูุงุก Backend
cd backend
npm install
npx prisma generate
npm run build

# 4. ุฅุนุงุฏุฉ ุชุดุบูู Backend
pm2 delete ticket-backend
pm2 start ecosystem.config.js

# 5. ุงูุชุญูู ูู ุงูุญุงูุฉ
pm2 list
pm2 logs ticket-backend --lines 20

# 6. ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู
curl -X POST http://localhost:3001/super-admin/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin","password":"admin123"}'

# 7. ุฅุนุงุฏุฉ ุจูุงุก Admin Dashboard
cd ../admin-dashboard
npm run build
sudo rm -rf /var/www/html/admin/*
sudo cp -r dist/* /var/www/html/admin/
sudo chown -R www-data:www-data /var/www/html/admin
```

## ๐ ุงุฎุชุจุงุฑ ุงููุธุงู:

### 1. ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู:
- ุฑุงุจุท: `http://136.111.97.150/admin/login`
- Username: `admin`
- Password: `admin123`

### 2. ุงุฎุชุจุงุฑ ุฅูุดุงุก ุดุฑูุฉ:
- ุจุนุฏ ุชุณุฌูู ุงูุฏุฎููุ ุงูุงูุชูุงู ุฅูู ุตูุญุฉ ุงูุดุฑูุงุช
- ุงูููุฑ ุนูู "ุฅุถุงูุฉ ุดุฑูุฉ ุฌุฏูุฏุฉ"
- ุงูุชุญูู ูู ุธููุฑ ุงูุญููู:
  - "ุงูุญุฏ ุงูุฃูุตู ููููุธููู"
  - "ุงูุณุนุฑ ููู ููุธู (ุฏููุงุฑ ุนุฑุงูู)"

## ๐ ููุงุญุธุงุช ูููุฉ:

1. **Cache ุงููุชุตูุญ:** ุฅุฐุง ูู ุชุธูุฑ ุงูุญููู ุงูุฌุฏูุฏุฉุ ุงุถุบุท `Ctrl+Shift+R` ูุชุญุฏูุซ ุงูุตูุญุฉ ุจุฏูู cache.

2. **Backend Restart:** ุฅุฐุง ูุงู Backend ูุง ูุนูู:
   - ุชุญูู ูู ูุฌูุฏ ููู `.env` ูุน `DATABASE_URL` ู `JWT_SECRET`
   - ุดุบู `npx prisma generate` ูุจู ุงูุจูุงุก
   - ุงุณุชุฎุฏู `pm2 logs ticket-backend` ููุญุต ุงูุฃุฎุทุงุก

3. **Database:** ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุธููุฉ ูุฌุงูุฒุฉ ููุฅูุชุงุฌ. ููุท Super Admin ููุฌูุฏ.

## โ ุงูุญุงูุฉ ุงูููุงุฆูุฉ:

- โ ุฌููุน ุงููุดุงูู ุชู ุฅุตูุงุญูุง ูู ุงูููุฏ ุงููุญูู
- โ ุงูููุฏ ูุญุฏุซ ููุตุญุญ
- โ ุงููููุน ุฌุงูุฒ ููุฅุทูุงู
- โ๏ธ ูุญุชุงุฌ ุฅูู ุชุทุจูู ุงูุชุญุฏูุซุงุช ุนูู ุงูุณูุฑูุฑ ุนูุฏ ุชููุฑ ุงูุงุชุตุงู

## ๐ ุงูุฏุนู:

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุชุญูู ูู logs: `pm2 logs ticket-backend`
2. ุชุญูู ูู ุญุงูุฉ Backend: `pm2 list`
3. ุชุญูู ูู ููู .env: `cat backend/.env`
4. ุฃุนุฏ ุจูุงุก ุงููุดุฑูุน: `npm run build`

